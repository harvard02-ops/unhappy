<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>2025å‹‡é—–å°ä¸­å“‡å°šå‹‡ â€” å¾Œå°ç®¡ç†</title>
<style>
  body{font-family:"Noto Sans TC",system-ui,Arial;margin:0;background:#f7f9fc;color:#333;}
  .container{max-width:900px;margin:24px auto;padding:18px;}
  header{display:flex;align-items:center;justify-content:space-between;}
  h1{font-size:20px;margin:0;color:#ff6f61;}
  table{width:100%;border-collapse:collapse;margin-top:18px;}
  th,td{padding:8px 12px;border:1px solid #e0e0e0;text-align:center;}
  th{background-color:#f5f5f5;}
  .btn{padding:6px 12px;background-color:#4CAF50;color:white;border:none;border-radius:4px;cursor:pointer;}
  .btn:hover{background-color:#45a049;}
</style>
</head>
<body>
<div class="container">
<header>
  <h1>ğŸ† 2025å‹‡é—–å°ä¸­å“‡å°šå‹‡ â€” å¾Œå°ç®¡ç†</h1>
  <button id="save-btn" class="btn">ğŸ’¾ å„²å­˜è‡³é›²ç«¯</button>
</header>

<table id="score-table">
<thead><tr><th>çµ„åˆ¥åç¨±</th><th>åˆ†æ•¸</th></tr></thead>
<tbody>
<tr><td><input type="text" value="Açµ„"/></td><td><input type="number" value="100"/></td></tr>
<tr><td><input type="text" value="Bçµ„"/></td><td><input type="number" value="90"/></td></tr>
<tr><td><input type="text" value="Cçµ„"/></td><td><input type="number" value="80"/></td></tr>
</tbody>
</table>

<div id="status">ç‹€æ…‹ï¼šæœªå„²å­˜</div>
</div>

<script>
const API_BASE_URL="https://script.google.com/macros/s/AKfycbwdy-kjizXyC4PXB9gEwQQ6k-kQU8afLFL9HvbA_FTHQAA-YxYrej8X55KYmq_rc_kn/exec";
const saveBtn=document.getElementById('save-btn');
const statusEl=document.getElementById('status');

saveBtn.addEventListener('click',async ()=>{
  const rows=Array.from(document.querySelectorAll('#score-table tbody tr'));
  const data=rows.map(r=>({
    group_name:r.cells[0].querySelector('input').value,
    score:r.cells[1].querySelector('input').value
  }));
  const pwd=prompt("è«‹è¼¸å…¥è€å¸«å¯†ç¢¼ï¼š");
  if(pwd!=="0857"){alert("å¯†ç¢¼éŒ¯èª¤ï¼");return;}

  try{
    const resp=await fetch(API_BASE_URL,{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({password:pwd,data})
    });
    const result=await resp.json();
    if(result.ok){statusEl.textContent="ç‹€æ…‹ï¼šæ›´æ–°æˆåŠŸï¼";}
    else{statusEl.textContent="ç‹€æ…‹ï¼šæ›´æ–°å¤±æ•—ï¼";}
  }catch(err){
    statusEl.textContent="ç‹€æ…‹ï¼šæ›´æ–°å¤±æ•—ï¼éŒ¯èª¤ï¼š"+err.message;
  }
});
</script>
</body>
</html>
